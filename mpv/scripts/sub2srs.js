parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"+7hG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isKanji=u,exports.mfold3=s,exports.mecab=i;var t="/bin/sh",r={t:"EOS"},e=function(t,r){return{t:"POSI",l:t,v:r}},n=function(t,r,e,n){return{t:"POSC",l:t,v:r,lemma:e,reading:n}};function u(t){return!!t.l.match(/[\u4E00-\u9FAF]/)}function s(t,r,e,n){return"EOS"===t.t?r(t):u(t)&&"POSC"===t.t?n(t):e(t)}function i(u){return mp.utils.subprocess({args:[t,"-c","echo '"+u+"' | mecab"]}).stdout.trim().split("\n").map(function(t){var u=t.split("\t"),s=u[0],i=u[1]?u[1].split(","):[],o=i[6],c=i[7];return"EOS"===s?r:o&&c?n(s,i,o,c):e(s,i)})}
},{}],"2gYS":[function(require,module,exports) {
"use strict";function s(s){var t=mp.utils.subprocess({args:["/usr/bin/curl","-s","-G","https://jisho.org/api/v1/search/words","--data-urlencode","keyword="+s]});return JSON.parse(t.stdout.trim()).data[0].senses.map(function(s){return s.english_definitions[0]}).join(" – ")}function t(s){var t=mp.utils.subprocess({args:["/usr/local/bin/myougiden","--color=no","-t",s]}).stdout.trim().split("\n")[0];if(t){var r=t.split("\t");return{definition:r[2].split("|")[0],lemmaReading:r[0]}}}Object.defineProperty(exports,"__esModule",{value:!0}),exports.jishoslow=s,exports.jisho=t;
},{}],"VcJz":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isNotBlackListed=u;var t=require("./mecab");function r(t,r){for(var e=0;e<t.length;e++)if(r(t[e]))return!0;return!1}var e=mp.utils.read_file("~/mpv-blacklist.txt")||"",n=e.trim().split("\n");function u(e){return(0,t.mfold3)(e,function(){return!0},function(){return!0},function(t){return!r(n,function(r){return r===t.lemma})})}
},{"./mecab":"+7hG"}],"ljwA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toHiragana=r;var e=["ぁ","あ","ぃ","い","ぅ","う","ぇ","え","ぉ","お","か","が","き","ぎ","く","ぐ","け","げ","こ","ご","さ","ざ","し","じ","す","ず","せ","ぜ","そ","ぞ","た","だ","ち","ぢ","っ","つ","づ","て","で","と","ど","な","に","ぬ","ね","の","は","ば","ぱ","ひ","び","ぴ","ふ","ぶ","ぷ","へ","べ","ぺ","ほ","ぼ","ぽ","ま","み","む","め","も","ゃ","や","ゅ","ゆ","ょ","よ","ら","り","る","れ","ろ","ゎ","わ","ゐ","ゑ","を","ん","ゔ","ゕ","ゖ","わ゛","ゐ゛","ゑ゛","を゛"],t=["ァ","ア","ィ","イ","ゥ","ウ","ェ","エ","ォ","オ","カ","ガ","キ","ギ","ク","グ","ケ","ゲ","コ","ゴ","サ","ザ","シ","ジ","ス","ズ","セ","ゼ","ソ","ゾ","タ","ダ","チ","ヂ","ッ","ツ","ヅ","テ","デ","ト","ド","ナ","ニ","ヌ","ネ","ノ","ハ","バ","パ","ヒ","ビ","ピ","フ","ブ","プ","ヘ","ベ","ペ","ホ","ボ","ポ","マ","ミ","ム","メ","モ","ャ","ヤ","ュ","ユ","ョ","ヨ","ラ","リ","ル","レ","ロ","ヮ","ワ","ヰ","ヱ","ヲ","ン","ヴ","ヵ","ヶ","ヷ","ヸ","ヹ","ヺ"];function r(r){return r.split("").map(function(r){return e[t.indexOf(r)]}).join("")}
},{}],"IeGY":[function(require,module,exports) {
"use strict";var r=require("./mecab"),e=require("./jisho"),n=require("./blacklist"),t=require("./kana"),s=.25,i=480,a=.08,o="sub2srs",u="Japanese sub2srs",p="sub2srs",m="/Users/pigoz/Library/Application Support/Anki2/User 1/collection.media",c="ffmpeg",g="curl";function d(r){var e=new Date(0);return e.setSeconds(r),e.toISOString().slice(11,23)}function f(r){return mp.utils.subprocess({args:["mktemp","-t","sub2srs"]}).stdout.trim()+"."+r}function l(r,e,n,t){var i=d(n-s),a=d(t-n+2*s),o=f("mp3"),u=[c,"-y","-ss",i,"-i",r,"-t",a,"-map","0:a:"+(e-1),o];return 0===mp.utils.subprocess({args:u}).status?o:""}function b(r,e,n){var t=d(e+(n-e)*a),s=f("jpg"),o=[c,"-y","-ss",t,"-i",r,"-vcodec","mjpeg","-vframes","1","-filter:v","scale="+i+":-1",s];return 0===mp.utils.subprocess({args:o}).status?s:""}function v(r,e){var n=JSON.stringify({action:r,version:6,params:e}),t=[g,"http://127.0.0.1:8765","--silent","--X","POST","--data",n];mp.msg.warn(t.join(" "));var s=mp.utils.subprocess({args:t});return mp.msg.warn(JSON.stringify(s)),JSON.parse(s.stdout)}function _(r,e){mp.utils.subprocess({args:["mv",r,e]})}function y(s,i,a,c,g){var f=mp.utils.join_path(m,k(a)),l=mp.utils.join_path(m,k(c)),b=g.replace("<","").replace(">",""),y=(0,r.mecab)(b),h=y.map(function(e){return(0,r.mfold3)(e,function(){return"\n"},function(r){return r.l},function(r){return" "+r.l+"["+(0,t.toHiragana)(r.reading)+"]"})}).join("").trim(),S=y.filter(function(r){return"POSC"===r.t}).filter(r.isKanji).filter(n.isNotBlackListed).map(function(r){var n=(0,e.jisho)(r.l);if(!n)return"";var s=n.lemmaReading||(0,t.toHiragana)(r.reading),i=n.definition.replace("[","(").replace("]",")");return r.l+"["+s+"] "+i}).join("<br>"),j={Source:s,Time:d(i),Sound:"[sound:"+k(a)+"]",Image:'<img src="'+k(c)+'" />',Line:b,Reading:h,Words:S};v("changeDeck",{cards:[],deck:o});var A=v("addNote",{note:{deckName:o,modelName:u,fields:j,tags:[p]}});A.result&&!A.error?(_(a,f),_(c,l),mp.osd_message("added「"+b+"」to Anki",6)):mp.osd_message("error invoking Anki API",6)}function k(r){var e=mp.utils.split_path(r);return e[e.length-1]}function h(r){var e=mp.get_property("path"),n=mp.get_property_number("aid")||1,t=[];t.push(mp.get_property("sub-text")||"");var s=mp.get_property_number("sub-start");for(var i=[function(){if(S("done"),e){var r=mp.get_property_number("sub-end");if(s&&r){var i=l(e,n,s,r),a=b(e,s,r),o=t.join("-");y(k(e),s,i,a,o.replace(/\n|\r/g," "))}else mp.msg.warn("cannot retrieve sub timings")}else mp.msg.warn("no path available")}],a=function(r){i[r]=function(){return e=i[r-1],mp.set_property_bool("pause",!0),mp.commandv("sub-seek","1"),void setTimeout(function(){t.push(mp.get_property("sub-text")||""),e()},500);var e}},o=1;o<r;o++)a(o);i[r-1]()}function S(r,e){mp.osd_message("sub2srs: "+r,e),mp.msg.warn(r)}function j(){S("how many contiguous subs? [0..9]",9999);var r=function(r){return"sub2srsN"+r},e=function(e){return function(){!function(){for(var e=0;e<10;e++)mp.remove_key_binding(r(e))}(),0!==e?(S("processing "+e+" contiguous subs"),h(e)):S("exiting modal mode")}};!function(){for(var n=0;n<10;n++)mp.add_forced_key_binding(n.toString(),r(n),e(n))}()}function A(){h(1)}mp.add_key_binding("b","sub2srs",j),mp.add_key_binding("GAMEPAD_BACK","sub2srs1",A);
},{"./mecab":"+7hG","./jisho":"2gYS","./blacklist":"VcJz","./kana":"ljwA"}]},{},["IeGY"], null)
//# sourceMappingURL=/sub2srs.map