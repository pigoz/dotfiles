parcelRequire=function(e,r,n,t){var i="function"==typeof parcelRequire&&parcelRequire,o="function"==typeof require&&require;function u(n,t){if(!r[n]){if(!e[n]){var f="function"==typeof parcelRequire&&parcelRequire;if(!t&&f)return f(n,!0);if(i)return i(n,!0);if(o&&"string"==typeof n)return o(n);var c=new Error("Cannot find module '"+n+"'");throw c.code="MODULE_NOT_FOUND",c}p.resolve=function(r){return e[n][1][r]||r},p.cache={};var l=r[n]=new u.Module(n);e[n][0].call(l.exports,p,l,l.exports,this)}return r[n].exports;function p(e){return u(p.resolve(e))}}u.isParcelRequire=!0,u.Module=function(e){this.id=e,this.bundle=u,this.exports={}},u.modules=e,u.cache=r,u.parent=i,u.register=function(r,n){e[r]=[function(e,r){r.exports=n},{}]};for(var f=0;f<n.length;f++)u(n[f]);if(n.length){var c=u(n[n.length-1]);"object"==typeof exports&&"undefined"!=typeof module?module.exports=c:"function"==typeof define&&define.amd?define(function(){return c}):t&&(this[t]=c)}return u}({"+7hG":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.isKanji=n,exports.mfold3=s,exports.mecab=u;var t="/bin/sh",r={t:"EOS"},e=function(t,r){return{t:"POS",l:t,v:r}};function n(t){return!!t.l.match(/[\u4E00-\u9FAF]/)}function s(t,r,e,s){return"EOS"===t.t?r(t):n(t)?s(t):e(t)}function u(n){return mp.utils.subprocess({args:[t,"-c","echo '"+n+"' | mecab"]}).stdout.trim().split("\n").map(function(t){var n=t.split("\t"),s=n[0],u=n[1]?n[1].split(","):[];return"EOS"===s?r:e(s,u)})}
},{}],"2gYS":[function(require,module,exports) {
"use strict";function s(s){var t=mp.utils.subprocess({args:["/usr/bin/curl","-s","-G","https://jisho.org/api/v1/search/words","--data-urlencode","keyword="+s]});return JSON.parse(t.stdout.trim()).data[0].senses.map(function(s){return s.english_definitions[0]}).join(" – ")}function t(s){var t=mp.utils.subprocess({args:["/usr/local/bin/myougiden","--color=no","-t",s]}).stdout.trim().split("\n")[0];return t?t.split("\t")[2].split("|")[0]:"–"}Object.defineProperty(exports,"__esModule",{value:!0}),exports.jishoslow=s,exports.jisho=t;
},{}],"ljwA":[function(require,module,exports) {
"use strict";Object.defineProperty(exports,"__esModule",{value:!0}),exports.toHiragana=r;var e=["ぁ","あ","ぃ","い","ぅ","う","ぇ","え","ぉ","お","か","が","き","ぎ","く","ぐ","け","げ","こ","ご","さ","ざ","し","じ","す","ず","せ","ぜ","そ","ぞ","た","だ","ち","ぢ","っ","つ","づ","て","で","と","ど","な","に","ぬ","ね","の","は","ば","ぱ","ひ","び","ぴ","ふ","ぶ","ぷ","へ","べ","ぺ","ほ","ぼ","ぽ","ま","み","む","め","も","ゃ","や","ゅ","ゆ","ょ","よ","ら","り","る","れ","ろ","ゎ","わ","ゐ","ゑ","を","ん","ゔ","ゕ","ゖ","わ゛","ゐ゛","ゑ゛","を゛"],t=["ァ","ア","ィ","イ","ゥ","ウ","ェ","エ","ォ","オ","カ","ガ","キ","ギ","ク","グ","ケ","ゲ","コ","ゴ","サ","ザ","シ","ジ","ス","ズ","セ","ゼ","ソ","ゾ","タ","ダ","チ","ヂ","ッ","ツ","ヅ","テ","デ","ト","ド","ナ","ニ","ヌ","ネ","ノ","ハ","バ","パ","ヒ","ビ","ピ","フ","ブ","プ","ヘ","ベ","ペ","ホ","ボ","ポ","マ","ミ","ム","メ","モ","ャ","ヤ","ュ","ユ","ョ","ヨ","ラ","リ","ル","レ","ロ","ヮ","ワ","ヰ","ヱ","ヲ","ン","ヴ","ヵ","ヶ","ヷ","ヸ","ヹ","ヺ"];function r(r){return r.split("").map(function(r){return e[t.indexOf(r)]}).join("")}
},{}],"IeGY":[function(require,module,exports) {
"use strict";var r=require("./mecab"),e=require("./jisho"),s=require("./kana"),t=.25,n=480,i=.08,a="sub2srs",u="Japanese sub2srs",p="sub2srs",o="/Users/pigoz/Library/Application Support/Anki2/User 1/collection.media",m="ffmpeg",c="curl";function l(r){var e=new Date(0);return e.setSeconds(r),e.toISOString().slice(11,23)}function g(r){return mp.utils.subprocess({args:["mktemp","-t","sub2srs"]}).stdout.trim()+"."+r}function d(r,e,s,n){var i=l(s-t),a=l(n-s+t),u=g("mp3"),p=[m,"-y","-ss",i,"-i",r,"-t",a,"-map","0:a:"+(e-1),u];return 0===mp.utils.subprocess({args:p}).status?u:""}function f(r,e,s){var t=l(e+(s-e)*i),a=g("jpg"),u=[m,"-y","-ss",t,"-i",r,"-vcodec","mjpeg","-vframes","1","-filter:v","scale="+n+":-1",a];return 0===mp.utils.subprocess({args:u}).status?a:""}function b(r,e){var s=JSON.stringify({action:r,version:6,params:e}),t=[c,"http://127.0.0.1:8765","--silent","--X","POST","--data",s];mp.msg.warn(t.join(" "));var n=mp.utils.subprocess({args:t});return mp.msg.warn(JSON.stringify(n)),JSON.parse(n.stdout)}function v(r,e){mp.utils.subprocess({args:["mv",r,e]})}function _(t,n,i,m,c){var g=mp.utils.join_path(o,k(i)),d=mp.utils.join_path(o,k(m)),f=c.replace("<","").replace(">",""),_=(0,r.mecab)(f),y=_.map(function(e){return(0,r.mfold3)(e,function(){return"\n"},function(r){return r.l},function(r){return" "+r.l+"["+(0,s.toHiragana)(r.v[7])+"]"})}).join("").trim(),S=_.filter(function(r){return"POS"===r.t}).filter(r.isKanji).map(function(r){return r.l+"["+(0,s.toHiragana)(r.v[7])+"] "+(0,e.jisho)(r.l).replace("[","(").replace("]",")")}).join("<br>"),h={Source:t,Time:l(n),Sound:"[sound:"+k(i)+"]",Image:'<img src="'+k(m)+'" />',Line:f,Reading:y,Words:S};b("changeDeck",{cards:[],deck:a});var j=b("addNote",{note:{deckName:a,modelName:u,fields:h,tags:[p]}});j.result&&!j.error?(v(i,g),v(m,d),mp.osd_message("added「"+f+"」to Anki",6)):mp.osd_message("error invoking Anki API",6)}function k(r){var e=mp.utils.split_path(r);return e[e.length-1]}function y(){var r=mp.get_property("sub-text"),e=mp.get_property("path"),s=mp.get_property_number("aid")||1;if(e)if(r){var t=mp.get_property_number("sub-start"),n=mp.get_property_number("sub-end");if(t&&n){var i=d(e,s,t,n),a=f(e,t,n);_(k(e),t,i,a,r.replace(/\n|\r/g," "))}else mp.msg.warn("cannot retrieve sub timings")}else mp.msg.warn("no subtitle is focused");else mp.msg.warn("no path available")}mp.add_key_binding("b","sub2anki",y),mp.add_key_binding("GAMEPAD_BACK","sub2anki",y);
},{"./mecab":"+7hG","./jisho":"2gYS","./kana":"ljwA"}]},{},["IeGY"], null)
//# sourceMappingURL=/sub2srs.map